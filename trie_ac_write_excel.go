package main

import (
	"fmt"

	"github.com/xuri/excelize/v2"
)

func trieACExcelMain() {
	f := excelize.NewFile()
	defer f.Close()

	// 设置表头
	headers := []string{
		"测试场景",
		"模式串数量",
		"Trie 性能 (ns/op)",
		"Trie 内存分配(B)",
		"Trie 分配次数",
		"AC 性能 (ns/op)",
		"AC 内存分配(B)",
		"AC 分配次数",
		"AC vs Trie 性能比",
	}
	for i, header := range headers {
		cell := fmt.Sprintf("%c1", 'A'+i)
		f.SetCellValue("Sheet1", cell, header)
	}

	// 写入数据
	data := [][]interface{}{
		{"短文本少模式串", 4, 352.6, 416, 4, 371.9, 416, 4, "-5.5%"},
		{"短文本多模式串", 50, 362.8, 416, 4, 380.8, 416, 4, "-5.0%"},
		{"中文文本重复模式", 9, 19620, 10616, 27, 21628, 10616, 27, "-10.2%"},
		{"英文文本重复模式", 9, 34672, 16248, 27, 32846, 16248, 27, "+5.3%"},
		{"混合文本大量模式", 100, 34739, 14672, 59, 32298, 14672, 59, "+7.0%"},
		{"长文本少量模式", 3, 81146, 35848, 13, 82202, 35848, 13, "-1.3%"},
		{"长文本大量模式", 200, 89150, 35848, 13, 93290, 35848, 13, "-4.6%"},
		{"模式串前缀重叠", 4, 42201, 31088, 41, 53281, 31088, 41, "-26.3%"},
		{"模式串后缀重叠", 4, 48444, 38000, 43, 55257, 38000, 43, "-14.1%"},
		{"特殊字符混合", 4, 14445, 7152, 31, 15078, 7152, 31, "-4.4%"},
		{"HTML文本", 6, 31510, 15968, 45, 31368, 15968, 45, "+0.5%"},
		{"URL文本", 6, 33387, 15712, 46, 32123, 15712, 46, "+3.8%"},
		{"JSON文本", 5, 31049, 13672, 38, 30142, 13672, 38, "+2.9%"},
	}

	for i, row := range data {
		for j, value := range row {
			cell := fmt.Sprintf("%c%d", 'A'+j, i+2)
			f.SetCellValue("Sheet1", cell, value)
		}
	}

	// 保存文件
	if err := f.SaveAs("trie_ac_性能对比.xlsx"); err != nil {
		fmt.Println(err)
	}
}
