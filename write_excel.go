package main

import (
	"fmt"

	"github.com/xuri/excelize/v2"
)

func excelMain() {
	f := excelize.NewFile()
	defer f.Close()

	// 设置表头
	headers := []string{
		"测试场景",
		"文本长度",
		"BF 性能 (ns/op)",
		"BF 内存分配(B)",
		"BF 分配次数",
		"KMP 性能 (ns/op)",
		"KMP 内存分配(B)",
		"KMP 分配次数",
		"KMP vs BF 性能比",
	}
	for i, header := range headers {
		cell := fmt.Sprintf("%c1", 'A'+i)
		f.SetCellValue("Sheet1", cell, header)
	}

	// 写入数据
	data := [][]interface{}{
		{"短文本最佳情况", 5, 27.96, 0, 0, 18.60, 0, 0, "+33.5%"},
		{"短文本最坏情况", 5, 30.27, 0, 0, 20.06, 0, 0, "+33.7%"},
		{"中文短文本完全匹配", 4, 53.33, 0, 0, 37.70, 0, 0, "+29.3%"},
		{"中文短文本不匹配", 4, 53.76, 0, 0, 40.10, 0, 0, "+25.4%"},
		{"中英混合文本", 14, 99.33, 0, 0, 67.61, 0, 0, "+32.0%"},
		{"中文重复文本", 10, 126.0, 0, 0, 92.43, 0, 0, "+26.6%"},
		{"中文重复不匹配", 2002, 31315, 8192, 1, 14065, 8192, 1, "+55.1%"},
		{"中文标点符号", 13, 145.1, 0, 0, 113.9, 0, 0, "+21.5%"},
		{"中文空格混合", 14, 125.5, 0, 0, 83.38, 0, 0, "+33.6%"},
		{"长中文文本短模式串", 4000, 35166, 16384, 1, 22284, 16384, 1, "+36.6%"},
		{"长中文文本长模式串", 4000, 32919, 16384, 1, 21127, 16544, 2, "+35.8%"},
		{"Unicode表情符号", 9, 108.1, 0, 0, 77.75, 0, 0, "+28.1%"},
		{"中文HTML标签", 19, 123.5, 0, 0, 87.13, 0, 0, "+29.4%"},
		{"中文URL匹配", 20, 142.8, 0, 0, 98.56, 0, 0, "+31.0%"},
		{"中文JSON内容", 31, 176.9, 0, 0, 126.3, 0, 0, "+28.6%"},
	}

	for i, row := range data {
		for j, value := range row {
			cell := fmt.Sprintf("%c%d", 'A'+j, i+2)
			f.SetCellValue("Sheet1", cell, value)
		}
	}

	// 保存文件
	if err := f.SaveAs("bl_kmp_test中文对比.xlsx"); err != nil {
		fmt.Println(err)
	}
}
